<?xml version="1.0" encoding="utf-8"?>
<slb-model-tree>
    <virtualServer name="t.dianping.com" state="ENABLED"
        availability="AVAILABLE" default-pool-name="Web.TuanGou.New"
        domain="t.dianping.com" port="80" creation-date="2013-12-13 16:01:44"
        last-modified-date="2013-12-13 16:12:34" version="3">
        <instances>
            <instance ip="10.2.8.14" />
            <instance ip="10.2.8.34" />
        </instances>
        <aspects>
            <aspect point-cut="BEFORE">
                <directive type="ifelse"
                    if-condition="$remote_addr = 124.131.180.74"
                    if-statement="proxy_pass http://node-10.1.1.70" />
            </aspect>
        </aspects>
        <locations>
            <location match-type="prefix" pattern="/dianping.xml"
                case-sensitive="true">
                <directive type="rewrite" matches="^/dianping.xml(.*)$"
                    flag="permanent" target-pattern="http://api.t.dianping.com/dianping.xml$1" />
            </location>
            <location match-type="prefix" pattern="/api.xml"
                case-sensitive="true">
                <directive type="rewrite" matches="^/api.xml(.*)$"
                    flag="permanent" target-pattern="http://api.t.dianping.com/n/api.xml$1" />
            </location>
            <location match-type="prefix" pattern="/360.xml"
                case-sensitive="true">
                <directive type="rewrite" matches="^/360.xml(.*)$"
                    flag="permanent" target-pattern="http://api.t.dianping.com/n/360.xml$1" />
            </location>
            <location match-type="prefix" pattern="/360api.xml"
                case-sensitive="true">
                <directive type="rewrite" matches="^/360api.xml(.*)$"
                    flag="permanent" target-pattern="http://api.t.dianping.com/n/360.xml$1" />
            </location>
            <location match-type="prefix" pattern="/tuanp.xml"
                case-sensitive="true">
                <directive type="rewrite" matches="^/tuanp.xml(.*)$"
                    flag="permanent" target-pattern="http://api.t.dianping.com/n/api.xml$1" />
            </location>
            <location match-type="prefix" pattern="/google.xml"
                case-sensitive="true">
                <directive type="rewrite" matches="^/google.xml(.*)$"
                    flag="permanent" target-pattern="http://api.t.dianping.com/n/google.xml$1" />
            </location>
            <location match-type="prefix" pattern="/hao123new.xml"
                case-sensitive="true">
                <directive type="rewrite" matches="^/hao123new.xml(.*)$"
                    flag="permanent" target-pattern="http://api.t.dianping.com/n/baidu.xml$1" />
            </location>
            <location match-type="prefix" pattern="/charge"
                case-sensitive="true">
                <directive type="rewrite" matches="^/charge(.*)$"
                    flag="permanent" target-pattern="http://o.p.dianping.com/order/charge$1" />
            </location>
            <location match-type="prefix" pattern="/citys.xml"
                case-sensitive="true">
                <directive type="rewrite" matches="^/citys.xml(.*)$"
                    flag="permanent" target-pattern="http://api.t.dianping.com/n/base/cities.xml$1" />
            </location>
            <location match-type="prefix" pattern="/buy/"
                case-sensitive="true">
                <directive type="rewrite" matches="^/(.*)$"
                    flag="permanent" target-pattern="http://o.p.dianping.com$1" />
            </location>
            <location match-type="prefix" pattern="/p/"
                case-sensitive="true">
                <directive type="rewrite" matches="^(.*)/p/(.*)$"
                    flag="break" target-pattern="$1/redirector/$2" />
                <directive type="proxy_pass" pool-name="base_cps-redirect-web" />
            </location>
            <location match-type="prefix" pattern="/sitemap/"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="node-10.1.7.191" />
            </location>
            <location match-type="prefix" pattern="/events/"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="tuangou_events" />
            </location>
            <location match-type="prefix" pattern="/subject/"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="tuangou_events" />
            </location>
            <location match-type="prefix" pattern="/topic/"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="tuan_tuangou-event" />
            </location>
            <location match-type="prefix" pattern="/topics/"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="tuan_tuangou-event" />
            </location>
            <location match-type="prefix" pattern="/event/"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="tuan_tuangou-event" />
            </location>
            <location match-type="regex" pattern="/sitemap-category-\d+.xml"
                case-sensitive="false">
                <!--大小写不区分 -->
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="regex" pattern="^.*\.xml"
                case-sensitive="false">
                <!--大小写不区分 -->
                <directive type="proxy_pass" pool-name="Web.TuanGou.API" />
            </location>
            <location match-type="regex" pattern="^.*\.xml\?.*"
                case-sensitive="false">
                <!--大小写不区分 -->
                <directive type="proxy_pass" pool-name="Web.TuanGou.API" />
            </location>
            <location match-type="prefix" pattern="/notify"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou.Notify" />
            </location>
            <location match-type="prefix" pattern="/paygate"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou.Notify" />
            </location>
            <location match-type="prefix" pattern="/movie"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="tuan_tuangou-web-movie" />
            </location>
            <location match-type="prefix" pattern="/hotelajax"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="tuan_tuangou-hotel" />
            </location>
            <location match-type="regex" pattern="^/\w+/hotel"
                case-sensitive="false">
                <!--大小写不区分 -->
                <directive type="proxy_pass" pool-name="tuan_tuangou-hotel" />
            </location>
            <location match-type="prefix" pattern="/ajax/login"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou.New" />
            </location>
            <location match-type="prefix" pattern="/ajax/"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="tuan_tuangou-web-sub" />
            </location>
            <location match-type="prefix" pattern="/redirect"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="tuan_tuangou-tracking" />
            </location>

            <location match-type="prefix" pattern="/t/img/icon/sina.png"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="prefix" pattern="/t/img/icon/qq.png"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="prefix" pattern="/charge"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="prefix" pattern="/verification"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="prefix" pattern="/return/alipay"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="prefix" pattern="/redirect"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="prefix" pattern="/deal.v"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="prefix" pattern="/order.v"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="prefix" pattern="/buy"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="prefix" pattern="/3thqueryorder"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="prefix" pattern="/pages.deal/dealindex.aspx"
                case-sensitive="true">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="regex" pattern="/\?q="
                case-sensitive="false">
                <directive type="proxy_pass" pool-name="Web.TuanGou" />
            </location>
            <location match-type="prefix" pattern="/biz"
                case-sensitive="true">
                <directive type="rewrite" matches="^/360api.xml(.*)$"
                    flag="permanent" target-pattern="http://v.t.dianping.com/login.aspx" />
            </location>
            <!--if没有写 if {$RequestIP == "124.131.180.74"} { node 10.1.1.70 
                } -->
        </locations>
    </virtualServer>
</slb-model-tree>